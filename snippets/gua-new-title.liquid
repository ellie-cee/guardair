{% comment %}
  new-title.liquid
  
  Usage: {% render 'new-title', title: 'Your Title String Here', remove_after_dash: true %}
  
  Parameters:
  - title: The string to process
  - remove_after_dash: true/false - whether to remove everything after dash (default: true)
  
  Rules applied:
  1. Remove everything after dash (-) - optional based on remove_after_dash parameter
  2. Remove specific words like "The" and "Classic+"
  3. Remove specific special characters (trademark, registered, etc.)
{% endcomment %}

{%- liquid
  assign processed_title = title
  
  # Set default value for remove_after_dash if not provided
  if remove_after_dash == blank
    assign remove_after_dash = true
  endif
-%}

{% comment %} Step 1: Remove everything after dash (including the dash) - conditional {% endcomment %}
{%- liquid
  if remove_after_dash and processed_title contains '-'
    assign dash_position = processed_title | split: '-' | first
    assign processed_title = dash_position
  endif
-%}

{% comment %} Step 2: Remove specific words {% endcomment %}
{%- liquid
  assign words_to_remove = 'The,Classic+,the,THE,classic+,CLASSIC+'
  assign words_array = words_to_remove | split: ','
  
  for word in words_array
    assign processed_title = processed_title | replace: word, ''
  endfor
-%}

{% comment %} Step 3: Remove specific special characters (trademark, registered, etc.) {% endcomment %}
{%- liquid
  assign special_chars = '®,™,©,℠'
  assign special_chars_array = special_chars | split: ','
  
  assign clean_title = processed_title
  
  for special_char in special_chars_array
    assign clean_title = clean_title | replace: special_char, ''
  endfor
-%}

{% comment %} Clean up multiple spaces and trim {% endcomment %}
{%- liquid
  assign clean_title = clean_title | replace: '  ', ' ' | replace: '   ', ' ' | strip
-%}

{% comment %} Assign result to output variable {% endcomment %}
{%- liquid
  assign new_title = clean_title
-%}
{{ new_title }}